<!DOCTYPE html><html lang="en"> <head><title>Hi, I'm Nhân - Why I use Linux -&nbsp;Automation</title><meta charset="utf-8"><link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Hi, I'm Nhân Full Atom Feed"><link href="/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Hi, I'm Nhân Atom Feed"><link href="/feeds/tutorials.atom.xml" type="application/atom+xml" rel="alternate" title="Hi, I'm Nhân Categories Atom Feed"><meta name="tags" content="python"><meta name="tags" content="linux"></head> <body id="index" class="home"> <header id="banner" class="body"> <h1><a href="https://hi.imnhan.com/">Hi, I'm Nhân <strong>and this is my humble corner on the interwebs.</strong></a></h1> </header><!-- /#banner --> <nav id="menu"><ul> <li><a href="/">Blog</a></li> <li><a href="https://hi.imnhan.com/about/">About</a></li> <li><a href="https://hi.imnhan.com/random-notes/">Random&nbsp;notes</a></li> <li><a href="https://hi.imnhan.com/category/misc/">misc</a></li> <li><a href="https://hi.imnhan.com/category/posts/">posts</a></li> <li><a href="https://hi.imnhan.com/category/side-projects/">side projects</a></li> <li class="active"><a href="https://hi.imnhan.com/category/tutorials/">tutorials</a></li> </ul></nav><!-- /#menu --> <section id="content" class="body"> <header> <h2 class="entry-title"> <a href="https://hi.imnhan.com/posts/why-i-use-linux-automation/" rel="bookmark" title="Permalink to Why I use Linux - Automation">Why I use Linux -&nbsp;Automation</a></h2> </header> <footer class="post-info"> <time class="published" datetime="2013-06-07T08:02:00+07:00"> Fri 07 June 2013 </time> <address class="vcard author"> By <a class="url fn" href="https://hi.imnhan.com/author/bui-thanh-nhan/">Bùi Thành Nhân</a> </address> <div class="category"> Category: <a href="https://hi.imnhan.com/category/tutorials/">tutorials</a> </div> <div class="tags"> Tags: <a href="https://hi.imnhan.com/tag/python/">python</a> <a href="https://hi.imnhan.com/tag/linux/">linux</a> </div> </footer><!-- /.post-info --> <div class="entry-content"> <p>(In this post, when I say Linux, I mean any popular <span class="caps">GNU</span>/Linux distribution. Hope this clarification will keep the nitpickers&nbsp;away.)</p> <p>First let&#8217;s discuss <em>why</em> automation&nbsp;rocks.</p> <h2>Repetition is evil (and&nbsp;boring)</h2> <p>As a (would-be) software engineer, the <em>repetition is evil</em> notion has been planted in my head for far more times than anything else, and for good&nbsp;reasons.</p> <p>People are far more prone to error than computers, and doing repetitive tasks creates just too much room for that. Computers, on the other hand, do everything exactly how you tell them to do, with extreme speed and&nbsp;accuracy.</p> <p>Moreover, let&#8217;s face it: We developers are all (or at least mostly) lazy. Not the &#8220;I&#8217;m don&#8217;t wanna do anything&#8221; kind of lazy, but more of the &#8220;This crap is boring and not challenging at all, why the hell am I wasting time for it?&#8221; type. We&#8217;ve all got better things to do with our lives, like re-watching the last episode of <span class="caps">BBC</span>&#8217;s <em>Sherlock</em> to look for clues to how he faked his death, or trying to figure out what that &#8220;Han shot first&#8221; meme means (sorry, I&#8217;m from the later&nbsp;generation).</p> <h2>Automation needs command line&nbsp;tools</h2> <p>Because, of course, <span class="caps">GUI</span> programs are (nearly) impossible to interact with in our scripts. Sure you can try mouse click emulation tools and stuff like that, but is it really worth the effort? And I&#8217;d bet anything that those tools are far from reliable (<span class="caps">GUI</span> latency,&nbsp;anyone?).</p> <p>And this is where Windows falls short. Most (if not all) Windows tools are designed for <span class="caps">GUI</span>, and the whole Windows ecosystem is built around <span class="caps">GUI</span>&nbsp;use.</p> <p>It&#8217;s a whole different matter in Linux: from the good old awk, sed, grep, wget to the new shiny aria2&#8230; Almost anything you can think of is available as a command line&nbsp;tool.</p> <h2>Putting them all&nbsp;together</h2> <p>Just like any <span class="caps">UNIX</span>-like system, Linux tools utilize the One True Phylosophy: Do only 1 thing, and do it well. (okay, I&#8217;m paraphrasing a bit, but you get the&nbsp;idea)</p> <p>The true power of command line tools is when they are used together. Let&#8217;s take a look at a <a href="https://gist.github.com/nhanb/5726342">python script</a> I wrote last night to download the whole beginner course from <a href="http://www.justinguitar.com">justinguitar</a>.</p> <p>The real flow starts from line&nbsp;48:</p> <div class="highlight"><pre><span></span><code><span class="c1"># Fetch index pages which has links to all beginner lessons</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;http://www.justinguitar.com/en/BC-000-BeginnersCourse.php&#39;</span><span class="p">)</span>
<span class="n">start_page</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">text</span>

<span class="c1"># Search for all links to lessons</span>
<span class="n">pat</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;a href=&quot;(BC-[0-9]</span><span class="si">{3}</span><span class="s1">-.+?)&quot;&#39;</span><span class="p">)</span>
<span class="n">pages</span> <span class="o">=</span> <span class="n">pat</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">start_page</span><span class="p">)</span>

<span class="c1"># Fetch html for each lesson</span>
<span class="n">pages_html</span> <span class="o">=</span> <span class="n">fetch_html</span><span class="p">(</span><span class="n">pages</span><span class="p">)</span>

<span class="c1"># Crawl each lesson page, pull out lesson names and youtube link code</span>
<span class="n">youtube_codes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">html</span> <span class="ow">in</span> <span class="n">pages_html</span><span class="p">:</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">parse_info</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="nb">print</span> <span class="n">code</span>
    <span class="k">if</span> <span class="n">code</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">youtube_codes</span><span class="p">:</span>
        <span class="n">youtube_codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</code></pre></div> <p>To summarize, this snippet goes to justinguitar&#8217;s beginner course index page, grab all links to each lesson, then grab the lesson title as well as the youtube video code to its video. The result is the list name <code>youtube_codes</code>; each element is a tuple with the format <code>(title, youtube_code)</code>.</p> <p>Then I use a command line tool called <code>youtube-dl</code> to fetch the direct link to each video. The tool itself can download the video too, but it doesn&#8217;t support multiple connections to accelerate the download. This is where <code>aria2c</code> jumps in: it takes the direct link from <code>youtube-dl</code> then download the whole&nbsp;thing:</p> <div class="highlight"><pre><span></span><code><span class="c1"># Leech the hell out of them</span>
<span class="k">for</span> <span class="n">lesson</span> <span class="ow">in</span> <span class="n">youtube_codes</span><span class="p">:</span>

    <span class="c1"># Ignore if lesson has no video</span>
    <span class="k">if</span> <span class="n">lesson</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">call</span><span class="p">([</span><span class="s1">&#39;touch&#39;</span><span class="p">,</span> <span class="n">lesson</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="k">continue</span>

    <span class="c1"># Use youtube-dl to get fresh download link and file extension</span>
    <span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;youtube-dl &#39;</span> <span class="o">+</span> <span class="n">lesson</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>\
            <span class="s1">&#39; --skip-download --get-url --get-filename -f 35/34/82/44/43/100&#39;</span>

    <span class="n">shell_output</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">check_output</span><span class="p">(</span><span class="n">command</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
    <span class="n">direct_link</span><span class="p">,</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">shell_output</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="n">file_ext</span> <span class="o">=</span> <span class="n">fname</span><span class="p">[</span><span class="n">fname</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):]</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">lesson</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">file_ext</span>

    <span class="c1"># Then aria2 for serious multi-part download acceleration</span>
    <span class="nb">print</span> <span class="s1">&#39;Downloading &#39;</span> <span class="o">+</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s1">&#39;...&#39;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;aria2c&#39;</span><span class="p">,</span> <span class="s2">&quot;-o&quot;</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;-x2&#39;</span><span class="p">,</span>
            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">direct_link</span><span class="p">]</span>
    <span class="n">shell_output</span> <span class="o">=</span> <span class="n">check_output</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
    <span class="nb">print</span> <span class="n">shell_output</span>
</code></pre></div> <p>That&#8217;s it! I just needed to launch this script, turn off the laptop screen and go to bed. This morning I woke up seeing the whole course with almost 100 lessons downloaded. Imagine having to manually download all that by clicking each link&#8230; You don&#8217;t wanna go there, do&nbsp;you?</p> <p>So that&#8217;s just a very simple example of what automation helps your every day life. Of course its true power is unleashed when used in development; this is how one-click test and deployment works. Windows can do this too, but your choice of tool will be limited. And don&#8217;t get me started on its lack of a decent package&nbsp;manager!</p> <p>To make a long story short, do yourself a favor and install a Linux&nbsp;distro.</p> <p>&#8230; or buy a&nbsp;Mac.</p> </div><!-- /.entry-content --> </section> <footer id="contentinfo" class="body"> <address id="about" class="vcard body"> Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>. </address><!-- /#about --> </footer><!-- /#contentinfo --> </body> </html>